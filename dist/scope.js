"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Scope = Scope;
exports.unscoped = unscoped;

var _typeorm = require("typeorm");

function Scope(scopes, enabled = true) {
  return function (target) {
    const table = (0, _typeorm.getMetadataArgsStorage)().tables.find(table => table.target === target);

    if (table) {
      table.scopes = scopes;
      table.scopesEnabled = enabled;
    } else {
      throw new Error("Could not find current entity in metadata store, maybe put @Scope() before @Entity()?");
    }
  };
}

function unscoped(connection, target) {
  const metadata = connection.getMetadata(target).tableMetadataArgs;
  metadata.scopesEnabled = false;
  return target;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zY29wZS50cyJdLCJuYW1lcyI6WyJTY29wZSIsInNjb3BlcyIsImVuYWJsZWQiLCJ0YXJnZXQiLCJ0YWJsZSIsInRhYmxlcyIsImZpbmQiLCJzY29wZXNFbmFibGVkIiwiRXJyb3IiLCJ1bnNjb3BlZCIsImNvbm5lY3Rpb24iLCJtZXRhZGF0YSIsImdldE1ldGFkYXRhIiwidGFibGVNZXRhZGF0YUFyZ3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7O0FBR08sU0FBU0EsS0FBVCxDQUF1QkMsTUFBdkIsRUFBdURDLE9BQU8sR0FBRyxJQUFqRSxFQUFpRjtBQUN2RixTQUFPLFVBQVVDLE1BQVYsRUFBNEI7QUFDbEMsVUFBTUMsS0FBSyxHQUFHLHVDQUF5QkMsTUFBekIsQ0FBZ0NDLElBQWhDLENBQXNDRixLQUFELElBQVdBLEtBQUssQ0FBQ0QsTUFBTixLQUFpQkEsTUFBakUsQ0FBZDs7QUFDQSxRQUFJQyxLQUFKLEVBQVc7QUFDVkEsTUFBQUEsS0FBSyxDQUFDSCxNQUFOLEdBQWVBLE1BQWY7QUFDQUcsTUFBQUEsS0FBSyxDQUFDRyxhQUFOLEdBQXNCTCxPQUF0QjtBQUNBLEtBSEQsTUFHTztBQUNOLFlBQU0sSUFBSU0sS0FBSixDQUFVLHVGQUFWLENBQU47QUFDQTtBQUNELEdBUkQ7QUFTQTs7QUFFTSxTQUFTQyxRQUFULENBQTBCQyxVQUExQixFQUFrRFAsTUFBbEQsRUFBOEU7QUFDcEYsUUFBTVEsUUFBUSxHQUFHRCxVQUFVLENBQUNFLFdBQVgsQ0FBdUJULE1BQXZCLEVBQStCVSxpQkFBaEQ7QUFDQUYsRUFBQUEsUUFBUSxDQUFDSixhQUFULEdBQXlCLEtBQXpCO0FBQ0EsU0FBT0osTUFBUDtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29ubmVjdGlvbiwgZ2V0TWV0YWRhdGFBcmdzU3RvcmFnZSwgT2JqZWN0VHlwZSB9IGZyb20gXCJ0eXBlb3JtXCJcbmltcG9ydCB7IFNjb3BlZFRhYmxlTWV0YWRhdGEsIFNjb3BlUUIgfSBmcm9tIFwiLi90YWJsZS1tZXRhZGF0YVwiXG5cbmV4cG9ydCBmdW5jdGlvbiBTY29wZTxFbnRpdHk+KHNjb3BlczogQXJyYXk8U2NvcGVRQjxFbnRpdHk+PiwgZW5hYmxlZCA9IHRydWUpOiBGdW5jdGlvbiB7XG5cdHJldHVybiBmdW5jdGlvbiAodGFyZ2V0OiBGdW5jdGlvbikge1xuXHRcdGNvbnN0IHRhYmxlID0gZ2V0TWV0YWRhdGFBcmdzU3RvcmFnZSgpLnRhYmxlcy5maW5kKCh0YWJsZSkgPT4gdGFibGUudGFyZ2V0ID09PSB0YXJnZXQpIGFzIFNjb3BlZFRhYmxlTWV0YWRhdGE8RW50aXR5PiB8IHVuZGVmaW5lZFxuXHRcdGlmICh0YWJsZSkge1xuXHRcdFx0dGFibGUuc2NvcGVzID0gc2NvcGVzXG5cdFx0XHR0YWJsZS5zY29wZXNFbmFibGVkID0gZW5hYmxlZFxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBjdXJyZW50IGVudGl0eSBpbiBtZXRhZGF0YSBzdG9yZSwgbWF5YmUgcHV0IEBTY29wZSgpIGJlZm9yZSBARW50aXR5KCk/XCIpXG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnNjb3BlZDxFbnRpdHk+KGNvbm5lY3Rpb246IENvbm5lY3Rpb24sIHRhcmdldDogT2JqZWN0VHlwZTxFbnRpdHk+KSB7XG5cdGNvbnN0IG1ldGFkYXRhID0gY29ubmVjdGlvbi5nZXRNZXRhZGF0YSh0YXJnZXQpLnRhYmxlTWV0YWRhdGFBcmdzIGFzIFNjb3BlZFRhYmxlTWV0YWRhdGE8RW50aXR5PlxuXHRtZXRhZGF0YS5zY29wZXNFbmFibGVkID0gZmFsc2Vcblx0cmV0dXJuIHRhcmdldFxufVxuIl19